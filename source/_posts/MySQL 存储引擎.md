---
title: MySQL 存储引擎
date: 2024-08-18
updated: 2024-08-1
category: MySQL
cover: https://tse3-mm.cn.bing.net/th/id/OIP-C.LvJiXW0ldtBwCwC5TBSh4QHaEK?w=321&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7
---

# MySQL 存储引擎

#### InnoDB

InnoDB 是一种兼顾高可靠性和高性能的通用存储引擎，在 MySQL 5.5 之后，InnoDB 是默认的 MySQL 存储引擎。

特点：

- DML 操作遵循 ACID 模型，支持事务；
- 行级锁，提高并发访问性能；
- 支持外键 FOREIGN KEY 约束，保证数据的完整性和正确性；

文件：

xxx.ibd：xxx 代表的是表名，innoDB 引擎的每张表都会对应这样一个表空间文件，存储该表的表结构（frm -早期的 、sdi -新版的）、数据和索引。

逻辑存储结构：

![InnoDB 逻辑存储结构](https://web-tlias-mmh.oss-cn-beijing.aliyuncs.com/img/image-20240820141945478.png)

- 表空间 : InnoDB 存储引擎逻辑结构的最高层，ibd 文件其实就是表空间文件，在表空间中可以包含多个 Segment (段)。
- 段 : 表空间是由各个段组成的， 常见的段有数据段、索引段、回滚段等。InnoDB 中对于段的管理，都是引擎自身完成，不需要人为对其控制，一个段中包含多个区。
- 区 : 区是表空间的单元结构，每个区的大小为 1M。 默认情况下， InnoDB 存储引擎页大小为 16K， 即一个区中一共有 64 个连续的页。
- 页 : 页是组成区的最小单元，**页也是InnoDB存储引擎磁盘管理的最小单元**，每个页的大小默认为 16KB。为了保证页的连续性，InnoDB 存储引擎每次从磁盘申请 4-5 个区。
- 行 : InnoDB 存储引擎是面向行的，也就是说数据是按行进行存放的，在每一行中除了定义表时所指定的字段以外，还包含两个隐藏字段。
  - Trx_id：每次对某条记录进行改动时，都会把对应的事务id赋值给 trx_id 隐藏列。
  - Roll_pointer：每次对某条引记录进行改动时，都会把旧的版本写入到 undo 日志中，然后这个隐藏列就相当于一个指针，可以通过它来找到该记录修改前的信息。




#### MyISAM

MyISAM是MySQL早期的默认存储引擎。

特点：

- 不支持事务，不支持外键
- 支持表锁，不支持行锁
- 访问速度快

文件：

- xxx.sdi：存储表结构信息
- xxx.MYD: 存储数据
- xxx.MYI: 存储索引



#### Memory

Memory引擎的表数据时存储在内存中的，由于受到硬件问题、或断电问题的影响，只能将这些表作为临时表或缓存使用。

特点：

- 内存存放
- hash索引（默认）

文件：

xxx.sdi：存储表结构信息



#### 区别及特点

| 特点         | InnoDB          | MyISAM | Memory |
| ------------ | --------------- | ------ | ------ |
| 存储限制     | 64TB            | 有     | 有     |
| 事务安全     | 支持            | -      | -      |
| 锁机制       | 行锁、表锁      | 表锁   | 表锁   |
| B+tree 索引  | 支持            | 支持   | 支持   |
| 全文索引     | 支持（5.6之后） | 支持   | 不支持 |
| Hash 索引    | 不支持          | 不支持 | 支持   |
| B-tree 索引  | 不支持          | 支持   | 不支持 |
| 空间使用     | 高              | 低     | N/A    |
| 内存使用     | 高              | 低     | 中等   |
| 批量插入速度 | 低              | 高     | 高     |
| 支持外键     | 支持            | -      | -      |

> InnoDB引擎与MyISAM引擎的区别 ?
>
> ①. InnoDB 引擎, 支持事务, 而 MyISAM 不支持。
>
> ②. InnoDB 引擎, 支持行锁和表锁, 而 MyISAM 仅支持表锁, 不支持行锁。
>
> ③. InnoDB 引擎, 支持外键, 而 MyISAM是 不支持的。
>
> ④. InnoDB 和 MyISAM 引擎数据结构都是 **B+ 树**



> 如何选择：
>
> - InnoDB: 是 MySQL 的默认存储引擎，支持事务、外键。如果应用对事务的完整性有比较高的要求，在并发条件下要求数据的一致性，数据操作除了插入和查询之外，还包含很多的更新、删除操作，那么 InnoDB 存储引擎是比较合适的选择。
> - MyISAM ： 如果应用是以读操作和插入操作为主，只有很少的更新和删除操作，并且对事务的完整性、并发性要求不是很高，那么选择这个存储引擎是非常合适的。
> - MEMORY：将所有数据保存在内存中，访问速度快，通常用于临时表及缓存。MEMORY 的缺陷就是对表的大小有限制，太大的表无法缓存在内存中，而且无法保障数据的安全性。